import Head from "next/head";
import { JobSearch } from "@/components/JobSearch/JobSearch";
import { getJobs } from "./api/jobs";
// import clientPromise from "@/database/mongodb.connect";

// type Props = {
//   jobs: [job]
// }

export default function Home({ jobs }: any) {
  return (
    <>
      <Head>
        <title>Latest Tech Jobs</title>
        <meta name="description" content="Generated by create next app" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <main className="container mx-auto h-screen mt-20">
        <div className="text-center">
          <h1 className="text-5xl font-black">FIND THE LATEST TECH JOBS</h1>
          <h3>Job Board curated for developers</h3>
        </div>
        <JobSearch />
        <div className="text-center">
          {jobs.map((job: any, index: any) => (
            <div key={index}>
              {job.title} - {job.remote && "true"} -{" "}
              {job.experience && "experienced"} -{" "}
              {job.employmentType && "Employed"} - {job.companyName} -{" "}
              {job.userEmail}
            </div>
          ))}
        </div>
      </main>
    </>
  );
}

export async function getServerSideProps() {
  try {
    const data = await getJobs();
    // let res = await fetch("http://localhost:3000/api/jobs");
    // let data = await res.json();
    return {
      props: { jobs: data },
    };
  } catch (e) {
    console.error(e);
  }
}
